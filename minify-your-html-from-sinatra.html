<!DOCTYPE html>
<html lang="en">
        <head>
                        <meta charset="utf-8" />
                        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                        <meta name="generator" content="Pelican" />
                        <title>"Minify your HTML from Sinatra"</title>
                        <link rel="stylesheet" href="http://lizard-spock.co.uk/pelican_test/theme/css/main.css" />
                                <link href="http://lizard-spock.co.uk/pelican_test/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Pelican Trial Atom Feed" />
    <meta name="description" content="Performance Programming Ruby Sinatra Web discuss_url: //155 url: //155/Minify_your_HTML_from_Sinatra id: 155 There are gzip compression options..." />
        </head>

        <body id="index" class="home">
                <header id="banner" class="body">
                        <h1><a href="http://lizard-spock.co.uk/pelican_test/">Pelican Trial</a></h1>
                        <nav><ul>
                                                <li><a href="http://lizard-spock.co.uk/pelican_test/category/outdoors.html">Outdoors</a></li>
                                                <li><a href="http://lizard-spock.co.uk/pelican_test/category/perforce.html">Perforce</a></li>
                                                <li class="active"><a href="http://lizard-spock.co.uk/pelican_test/category/posts.html">posts</a></li>
                                                <li><a href="http://lizard-spock.co.uk/pelican_test/category/python.html">Python</a></li>
                        </ul></nav>
                </header><!-- /#banner -->
  <section id="content" class="body">
    <article>
      <header>
        <h1 class="entry-title">
          <a href="http://lizard-spock.co.uk/pelican_test/minify-your-html-from-sinatra.html" rel="bookmark"
             title="Permalink to "Minify your HTML from Sinatra"">"Minify your HTML from Sinatra"</a></h1>
      </header>

      <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-04-26T15:13:49+01:00">
                Published: Thu 26 April 2012
        </abbr>

                <address class="vcard author">
                        By                                 <a class="url fn" href="http://lizard-spock.co.uk/pelican_test/author/morganp.html">morganp</a>
                </address>
        <p>In <a href="http://lizard-spock.co.uk/pelican_test/category/posts.html">posts</a>.</p>
        
</footer><!-- /.post-info -->        <ul>
<li>Performance</li>
<li>Programming</li>
<li>Ruby</li>
<li>Sinatra</li>
<li>Web
discuss_url: //155
url: //155/Minify_your_HTML_from_Sinatra
id: 155</li>
</ul>
<hr>
<p>There are gzip compression options available but when I looked at this a long time ago I found that the extra server load to compress (with out caching) and the extra delay in the browser to decompress was not worth the few bytes it saved and lead to longer times before seeing the fully rendered page.</p>
<p>Minification or minifying is more about removing white space, in the case of javascript it can also optimise variable names. For html we would not want to do that unless our css was going to be converted to match exactly. </p>
<p>After a little digging and trying a few gems which failed to set there dependancies correctly and even <code>required 'pp'</code>*, I found TidyFFI.</p>
<ul>
<li>Really useful for debugging but I do not think has a place in deployed code.</li>
</ul>
<h1>Minify HTML</h1>
<div class="highlight"><pre><span></span><code>gem install TidyFFI
</code></pre></div>

<p>Before:</p>
<div class="highlight"><pre><span></span><code><span class="nv">get</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="nv">erb</span><span class="w"> </span>:<span class="s1">&#39;about&#39;</span>
<span class="k">end</span>
</code></pre></div>

<p>After :</p>
<div class="highlight"><pre><span></span><code>require &#39;tidy_ffi&#39;
get &#39;/&#39; do
  TidyFFI::Tidy.new( erb :&#39;about&#39; ).clean 
end
</code></pre></div>
      </div><!-- /.entry-content -->

    </article>
  </section>
                <section id="extras" class="body">
                                <div class="social">
                                        <h2>social</h2>
                                        <ul>
                                                        <li><a href="http://lizard-spock.co.uk/pelican_test/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                                        </ul>
                                </div><!-- /.social -->
                </section><!-- /#extras -->

                <footer id="contentinfo" class="body">
                        <address id="about" class="vcard body">
                                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                        </address><!-- /#about -->

                        <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
                </footer><!-- /#contentinfo -->

        </body>
</html>